{
  "entities": {
    "User": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "User",
      "type": "object",
      "description": "Represents a user of the MAYA-NETRA AI platform.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the User entity."
        },
        "email": {
          "type": "string",
          "description": "Email address of the user.",
          "format": "email"
        },
        "name": {
          "type": "string",
          "description": "User's full name."
        },
        "creationDate": {
          "type": "string",
          "description": "Date and time when the user account was created.",
          "format": "date-time"
        }
      },
      "required": [
        "id",
        "email",
        "name",
        "creationDate"
      ]
    },
    "AnalysisRequest": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "AnalysisRequest",
      "type": "object",
      "description": "Represents a request to analyze an image or video.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the AnalysisRequest entity."
        },
        "userId": {
          "type": "string",
          "description": "Reference to User. (Relationship: User 1:N AnalysisRequest)"
        },
        "fileType": {
          "type": "string",
          "description": "Type of file uploaded (e.g., 'image', 'video')."
        },
        "fileName": {
          "type": "string",
          "description": "Name of the uploaded file."
        },
        "uploadDate": {
          "type": "string",
          "description": "Date and time when the file was uploaded.",
          "format": "date-time"
        },
        "status": {
          "type": "string",
          "description": "Current status of the analysis (e.g., 'pending', 'processing', 'completed', 'failed')."
        }
      },
      "required": [
        "id",
        "userId",
        "fileType",
        "fileName",
        "uploadDate",
        "status"
      ]
    },
    "AnalysisResult": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "AnalysisResult",
      "type": "object",
      "description": "Represents the results of analyzing an image or video.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the AnalysisResult entity."
        },
        "analysisRequestId": {
          "type": "string",
          "description": "Reference to AnalysisRequest. (Relationship: AnalysisRequest 1:1 AnalysisResult)"
        },
        "confidenceScore": {
          "type": "number",
          "description": "Confidence score (0-100%) of the AI detection."
        },
        "label": {
          "type": "string",
          "description": "Label indicating whether the content is 'Real' or 'AI-Generated'."
        },
        "inferenceTime": {
          "type": "number",
          "description": "Inference time in milliseconds."
        },
        "explanation": {
          "type": "string",
          "description": "Explanation generated by the LLM tool, highlighting regions of interest."
        }
      },
      "required": [
        "id",
        "analysisRequestId",
        "confidenceScore",
        "label",
        "inferenceTime"
      ]
    }
  },
  "auth": {
    "providers": [
      "password",
      "anonymous"
    ]
  },
  "firestore": {
    "structure": [
      {
        "path": "/users/{userId}",
        "definition": {
          "entityName": "User",
          "schema": {
            "$ref": "#/backend/entities/User"
          },
          "description": "Stores user profile information. Path-based ownership ensures only the user can access their data.",
          "params": [
            {
              "name": "userId",
              "description": "The unique identifier for the user."
            }
          ]
        }
      },
      {
        "path": "/users/{userId}/analysisRequests/{analysisRequestId}",
        "definition": {
          "entityName": "AnalysisRequest",
          "schema": {
            "$ref": "#/backend/entities/AnalysisRequest"
          },
          "description": "Stores analysis requests associated with a user. Path-based ownership.",
          "params": [
            {
              "name": "userId",
              "description": "The unique identifier for the user."
            },
            {
              "name": "analysisRequestId",
              "description": "The unique identifier for the analysis request."
            }
          ]
        }
      },
      {
        "path": "/analysisResults/{analysisResultId}",
        "definition": {
          "entityName": "AnalysisResult",
          "schema": {
            "$ref": "#/backend/entities/AnalysisResult"
          },
          "description": "Stores analysis results. Includes denormalized 'userId' field for authorization independence and simplified querying.",
          "params": [
            {
              "name": "analysisResultId",
              "description": "The unique identifier for the analysis result."
            }
          ]
        }
      }
    ],
    "reasoning": "The Firestore data structure is designed to ensure Authorization Independence, clarity, and scalability. User data is stored under `/users/{userId}`. Analysis requests are stored under `/users/{userId}/analysisRequests/{analysisRequestId}`, ensuring that each request is associated with a specific user. Analysis results are stored under `/analysisResults/{analysisResultId}`, with a denormalized `userId` field for simplified querying and security rules, thus promoting Authorization Independence by avoiding the need for `get()` calls to the parent `analysisRequest` document. This supports secure list operations (QAPs) as rules can directly filter based on the `userId` within the `analysisResults` collection. Using path-based ownership for User data and a separate global collection with denormalized ownership for AnalysisResults provides a scalable and secure solution."
  }
}